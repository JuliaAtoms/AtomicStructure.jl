<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Equation systems · Atoms</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script src="../assets/latex.js"></script></head><body><nav class="toc"><h1>Atoms</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><span class="toctext">Theory</span><ul><li><a class="toctext" href="../density_matrices/">Density matrices</a></li></ul></li><li><span class="toctext">Implementation</span><ul><li><a class="toctext" href="../radial_orbitals/">Radial orbitals</a></li><li><a class="toctext" href="../atom_types/">Atom types</a></li><li><a class="toctext" href="../one_body/">One-body Hamiltonians</a></li><li><a class="toctext" href="../hydrogenic/">Hydrogenic initialization</a></li><li><a class="toctext" href="../orbital_equations/">Orbital equations</a></li><li class="current"><a class="toctext" href>Equation systems</a><ul class="internal"><li><a class="toctext" href="#Common-integrals-1">Common integrals</a></li></ul></li><li><a class="toctext" href="../observables/">Observables</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Implementation</li><li><a href>Equation systems</a></li></ul><a class="edit-page" href="https://github.com/JuliaAtoms/Atoms.jl/blob/master/docs/src/equation_systems.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Equation systems</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Equation-systems-1" href="#Equation-systems-1">Equation systems</a></h1><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Atoms.AtomicEquations" href="#Atoms.AtomicEquations"><code>Atoms.AtomicEquations</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-none">AtomicEquations(atom, equations, integrals)</code></pre><p>Structure representing the (e.g. Hartree–Fock) <code>equations</code> for <code>atom</code>, along with all <code>integrals</code> that are shared between the <code>equations</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/89f86436bc45251a2e6f53eb000ef2d68ea5b7df/src/equations.jl#L3-L8">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SCF.update!-Tuple{Atoms.AtomicEquations}" href="#SCF.update!-Tuple{Atoms.AtomicEquations}"><code>SCF.update!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">update!(equations::AtomicEquations)</code></pre><p>Recompute all integrals using the current values for the radial orbitals.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/89f86436bc45251a2e6f53eb000ef2d68ea5b7df/src/equations.jl#L23-L27">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="SCF.energy_matrix!-Union{Tuple{HM}, Tuple{HM,AtomicEquations}, Tuple{HM,AtomicEquations,Symbol}} where HM&lt;:(AbstractArray{T,2} where T)" href="#SCF.energy_matrix!-Union{Tuple{HM}, Tuple{HM,AtomicEquations}, Tuple{HM,AtomicEquations,Symbol}} where HM&lt;:(AbstractArray{T,2} where T)"><code>SCF.energy_matrix!</code></a> — <span class="docstring-category">Method</span>.</div><div><div><pre><code class="language-none">energy_matrix!(H, hfeqs::AtomicEquations[, which=:energy])</code></pre><p>Compute the energy matrix by computing the energy observable and storing it in <code>H</code>. Requires that <code>hfeqs</code> has the <code>:energy</code> and <code>:kinetic_energy</code> <a href="../observables/#Atoms.Observable"><code>Observable</code></a>s registered (this is the default).</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/89f86436bc45251a2e6f53eb000ef2d68ea5b7df/src/equations.jl#L32-L39">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Atoms.find_symmetries" href="#Atoms.find_symmetries"><code>Atoms.find_symmetries</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">find_symmetries(orbitals)</code></pre><p>Group all orbitals according to their symmetries, e.g. ℓ for <code>Orbital</code>s. This is used to determine which off-diagonal Lagrange multipliers are necessary to maintain orthogonality.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/89f86436bc45251a2e6f53eb000ef2d68ea5b7df/src/equations.jl#L48-L54">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Atoms.generate_atomic_orbital_equations" href="#Atoms.generate_atomic_orbital_equations"><code>Atoms.generate_atomic_orbital_equations</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">generate_atomic_orbital_equations(atom::Atom, eqs::MCEquationSystem,
                                  integrals, integral_map)</code></pre><p>For each variationally derived orbital equation in <code>eqs</code>, generate the corresponding <a href="../orbital_equations/#Atoms.AtomicOrbitalEquation"><code>AtomicOrbitalEquation</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/89f86436bc45251a2e6f53eb000ef2d68ea5b7df/src/equations.jl#L89-L95">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.diff" href="#Base.diff"><code>Base.diff</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">diff(atom[, H]; overlaps=[], selector=outsidecoremodel, verbosity=0)</code></pre><p>Differentiate the energy expression of the Hamiltonian <code>H</code> associated with the <code>atom</code>&#39;s configurations(s) with respect to the atomic orbitals to derive the Hartree–Fock equations for the orbitals.</p><p>By default, the Hamiltonian <code>H=FieldFreeOneBodyHamiltonian()+CoulombInteraction()</code>.</p><p>Non-orthogonality between orbitals can be specified by providing <code>OrbitalOverlap</code>s between these pairs. Only those electrons not modelled by <code>atom.potential</code> of each configuration are considered for generating the energy expression, this can be changed by choosing another value for <code>selector</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/89f86436bc45251a2e6f53eb000ef2d68ea5b7df/src/equations.jl#L134-L149">source</a></section><h2><a class="nav-anchor" id="Common-integrals-1" href="#Common-integrals-1">Common integrals</a></h2><p>When deriving the equations of motion from an energy expression, the same integral may appear many times in the equations for different orbitals, multiplied by different factors, etc. To minimize the reevaluation of integrals, <a href="#Atoms.AtomicEquations"><code>AtomicEquations</code></a> keeps track of all the common integrals, and they are recomputed exactly once, when <a href="../orbital_equations/#SCF.update!-Tuple{Atoms.OrbitalOverlapIntegral}"><code>SCF.update!</code></a> is called. The routines below are used when setting up the equation system.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Atoms.push_common_integral!" href="#Atoms.push_common_integral!"><code>Atoms.push_common_integral!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">push_common_integral!(integrals, integral_map,
                      integral, atom)</code></pre><p>Push the <code>integral</code> to <code>integrals</code>, constructing the correct <a href="../orbital_equations/#Atoms.OrbitalIntegral"><code>OrbitalIntegral</code></a> pertaining to the <code>atom</code>. Record the index of <code>integral</code> in <code>integrals</code> in the <code>integral_map</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/89f86436bc45251a2e6f53eb000ef2d68ea5b7df/src/common_integrals.jl#L1-L8">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Atoms.pushterms!" href="#Atoms.pushterms!"><code>Atoms.pushterms!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-none">pushterms!(terms, operator, equation_terms,
           integrals, integral_map, symbolic_integrals)</code></pre><p>For each term in <code>equation_terms</code>, push a term, located at CI coordinates <code>i,j</code>, of the overall orbital Hamiltonian to <code>terms</code>, constructed from <code>operator</code> and a product of orbital <code>integrals</code>, multiplied by an overall factor given by expression and multipole expansions. <code>integrals</code> contain common <a href="../orbital_equations/#Atoms.OrbitalIntegral"><code>OrbitalIntegral</code></a>s and <code>integral_map</code> maps from <code>symbolic_integrals</code> to <code>integrals</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/89f86436bc45251a2e6f53eb000ef2d68ea5b7df/src/common_integrals.jl#L43-L53">source</a></section><footer><hr/><a class="previous" href="../orbital_equations/"><span class="direction">Previous</span><span class="title">Orbital equations</span></a><a class="next" href="../observables/"><span class="direction">Next</span><span class="title">Observables</span></a></footer></article></body></html>
