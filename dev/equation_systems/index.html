<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Equation systems · Atoms</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Atoms</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../density_matrices/">Density matrices</a></li></ul></li><li><span class="tocitem">Implementation</span><ul><li><a class="tocitem" href="../radial_orbitals/">Radial orbitals</a></li><li><a class="tocitem" href="../atom_types/">Atom types</a></li><li><a class="tocitem" href="../one_body/">One-body Hamiltonians</a></li><li><a class="tocitem" href="../hydrogenic/">Hydrogenic initialization</a></li><li><a class="tocitem" href="../orbital_equations/">Orbital equations</a></li><li class="is-active"><a class="tocitem" href>Equation systems</a><ul class="internal"><li><a class="tocitem" href="#Common-integrals"><span>Common integrals</span></a></li></ul></li><li><a class="tocitem" href="../observables/">Observables</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Implementation</a></li><li class="is-active"><a href>Equation systems</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Equation systems</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaAtoms/Atoms.jl/blob/master/docs/src/equation_systems.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Equation-systems"><a class="docs-heading-anchor" href="#Equation-systems">Equation systems</a><a id="Equation-systems-1"></a><a class="docs-heading-anchor-permalink" href="#Equation-systems" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="Atoms.AtomicEquations" href="#Atoms.AtomicEquations"><code>Atoms.AtomicEquations</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AtomicEquations(atom, equations, integrals)</code></pre><p>Structure representing the (e.g. Hartree–Fock) <code>equations</code> for <code>atom</code>, along with all <code>integrals</code> that are shared between the <code>equations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/equations.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Atoms.SCF.update!-Tuple{Atoms.AtomicEquations}" href="#Atoms.SCF.update!-Tuple{Atoms.AtomicEquations}"><code>Atoms.SCF.update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SCF.update!(p::DirectPotential)</code></pre><p>Update the direct potential <code>p</code> by solving the Poisson problem with the current values of the orbitals forming the mutual density.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/orbital_integrals.jl#L199-L204">source</a></section><section><div><pre><code class="nohighlight hljs">SCF.update!(p::DirectPotential, atom::Atom)</code></pre><p>Update the direct potential <code>p</code> by solving the Poisson problem with the current values of the orbitals of <code>atom</code> forming the mutual density.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/orbital_integrals.jl#L211-L217">source</a></section><section><div><pre><code class="nohighlight hljs">update!(equations::AtomicEquations[, atom::Atom])</code></pre><p>Recompute all integrals using the current values for the radial orbitals (optionally specifying which <code>atom</code> from which the orbitals are taken).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/equations.jl#L26-L32">source</a></section><section><div><pre><code class="nohighlight hljs">update!(eqs; kwargs...)</code></pre><p>Update the equation system <code>eqs</code>, for the current iteration. <em>To be overloaded by the user.</em></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/SCF/fock.jl#L106-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Atoms.SCF.energy_matrix!-Union{Tuple{HM}, Tuple{HM, Atoms.AtomicEquations}, Tuple{HM, Atoms.AtomicEquations, Symbol}} where HM&lt;:(AbstractMatrix)" href="#Atoms.SCF.energy_matrix!-Union{Tuple{HM}, Tuple{HM, Atoms.AtomicEquations}, Tuple{HM, Atoms.AtomicEquations, Symbol}} where HM&lt;:(AbstractMatrix)"><code>Atoms.SCF.energy_matrix!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">energy_matrix!(H, hfeqs::AtomicEquations[, which=:energy])</code></pre><p>Compute the energy matrix by computing the energy observable and storing it in <code>H</code>. Requires that <code>hfeqs</code> has the <code>:energy</code> and <code>:kinetic_energy</code> <a href="../observables/#Atoms.Observable"><code>Observable</code></a>s registered (this is the default).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/equations.jl#L44-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Atoms.find_symmetries" href="#Atoms.find_symmetries"><code>Atoms.find_symmetries</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">find_symmetries(orbitals)</code></pre><p>Group all orbitals according to their symmetries, e.g. ℓ for <code>Orbital</code>s. This is used to determine which off-diagonal Lagrange multipliers are necessary to maintain orthogonality.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/equations.jl#L60-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Atoms.generate_atomic_orbital_equations" href="#Atoms.generate_atomic_orbital_equations"><code>Atoms.generate_atomic_orbital_equations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_atomic_orbital_equations(atom::Atom, eqs::MCEquationSystem,
                                  integrals, integral_map)</code></pre><p>For each variationally derived orbital equation in <code>eqs</code>, generate the corresponding <a href="../orbital_equations/#Atoms.AtomicOrbitalEquation"><code>AtomicOrbitalEquation</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/equations.jl#L138-L144">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.diff" href="#Base.diff"><code>Base.diff</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">diff(atom; H=atomic_hamiltonian(atom), overlaps=[], selector=outsidecoremodel, verbosity=0)</code></pre><p>Differentiate the energy expression of the Hamiltonian <code>H</code> associated with the <code>atom</code>&#39;s configurations(s) with respect to the atomic orbitals to derive the Hartree–Fock equations for the orbitals.</p><p>By default, the Hamiltonian <code>H=FieldFreeOneBodyHamiltonian()+CoulombInteraction()</code>.</p><p>Non-orthogonality between orbitals can be specified by providing <code>OrbitalOverlap</code>s between these pairs. Only those electrons not modelled by <code>atom.potential</code> of each configuration are considered for generating the energy expression, this can be changed by choosing another value for <code>selector</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/equations.jl#L201-L216">source</a></section><section><div><pre><code class="nohighlight hljs">diff(quantum_system[; kwargs...])</code></pre><p>Varies the the <code>quantum_system</code> with respect to all orbitals. Used to derive the multi-configurational Hartree–Fock equations. To be overloaded by the implementation of <a href="@ref"><code>AbstractQuantumSystem</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/SCF/quantum_systems.jl#L31-L37">source</a></section></article><h2 id="Common-integrals"><a class="docs-heading-anchor" href="#Common-integrals">Common integrals</a><a id="Common-integrals-1"></a><a class="docs-heading-anchor-permalink" href="#Common-integrals" title="Permalink"></a></h2><p>When deriving the equations of motion from an energy expression, the same integral may appear many times in the equations for different orbitals, multiplied by different factors, etc. To minimize the reevaluation of integrals, <a href="#Atoms.AtomicEquations"><code>AtomicEquations</code></a> keeps track of all the common integrals, and they are recomputed exactly once, when <a href="#Atoms.SCF.update!-Tuple{Atoms.AtomicEquations}"><code>SCF.update!</code></a> is called. The routines below are used when setting up the equation system.</p><article class="docstring"><header><a class="docstring-binding" id="Atoms.pushterms!" href="#Atoms.pushterms!"><code>Atoms.pushterms!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pushterms!(terms, operator, equation_terms,
           integrals, integral_map, symbolic_integrals)</code></pre><p>For each term in <code>equation_terms</code>, push a term, located at CI coordinates <code>i,j</code>, of the overall orbital Hamiltonian to <code>terms</code>, constructed from <code>operator</code> and a product of orbital <code>integrals</code>, multiplied by an overall factor given by expression and multipole expansions. <code>integrals</code> contain common <a href="../orbital_equations/#Atoms.OrbitalIntegral"><code>OrbitalIntegral</code></a>s and <code>integral_map</code> maps from <code>symbolic_integrals</code> to <code>integrals</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAtoms/Atoms.jl/blob/2c34df14cfcc08d82e9463ffc54f19b5d90dd221/src/common_integrals.jl#L86-L96">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../orbital_equations/">« Orbital equations</a><a class="docs-footer-nextpage" href="../observables/">Observables »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Monday 1 August 2022 13:57">Monday 1 August 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
